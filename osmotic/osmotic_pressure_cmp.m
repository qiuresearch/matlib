function pressure = osmotic_pressure_cmp(concen, pegtype, temperature)
% --- Usage:
%        pressure = osmotic_pressure(concen, pegtype, temperature)
% --- Purpose:
%        get the tabulated osmotic pressure.
%
% --- Parameter(s):
%        concen   - weight fraction of PEG
%        pegtype  - "PEG8K", ...
%        temperature - 20 (default)
%
% --- Return(s): 
%
% --- Example(s):
%
% $Id: osmotic_pressure_cmp.m,v 1.2 2013/04/03 16:04:26 xqiu Exp $
%

verbose = 1;
concen = 0.01:0.01:0.6;

figure_format('tinyprint');
figure(1); clf;

subplot(1,2,1); hold all;

% #1) PEG8k 20C the most commonly used data
hplot = plot(concen, osmotic_pressure(concen, 'PEG8k', 20));
legend(hplot, 'PEG8K 20C, GW default from NIH in 2008');

hplot = plot(concen, osmotic_pressure(concen, 'PEG8k', 25, 'NIH2013'));
legend_add(hplot, 'PEG8K 25C, NIH2013 formula');

% New data from Don 11/13/2012

osmop8k25_data = [ ...
0.4800     7.9457; ...
0.4400     7.8160; ...       
0.4000     7.6930; ...       
0.3600     7.5710; ...       
0.3200     7.4165; ...       
0.2790     7.2633; ...       
0.2390     7.0855; ...           
0.1990     6.9085; ...           
0.1590     6.6710; ...           
0.1200     6.4392; ...           
0.3990     7.6655; ...           
0.3000     7.3001; ...           
0.1510     6.5203; ...           
0.2010     6.8433; ...           
0.2510     7.0976; ...           
0.3000     7.3138; ...           
0.3490     7.5096; ...           
0.3980     7.6800; ...           
0.4500     7.8521 ];

hplot = plot(osmop8k25_data(:,1), osmop8k25_data(:,2), 'o');
legend_add(hplot, 'PEG8K 25C, NIH 11/13/2012');

axis tight;
legend boxoff

% PEG20k 20C (formula from LPSB website)
subplot(1,2,2); hold all;

hplot = plot(concen, osmotic_pressure(concen, 'PEG20k', 20));
legend_add(hplot, 'PEG20K 20C, GW default from LPSB website');

% PEG20k 20C data from LPSB website
% http://lpsb.nichd.nih.gov/peg20000.htm
osmop20k_data = [ ...
1.5 	4.59; ...
2.9 	4.98; ...
3.6 	5.15; ...
4.7 	5.34; ...
5.8 	5.55; ...
6.3 	5.63; ...
7.1 	5.76; ...
9.0 	5.89; ...
12.1 	6.08; ...
13.1 	6.18; ...
14.2 	6.29; ...
16.0 	6.47; ...
18.3 	6.70; ...
18.8 	6.68; ...
20.8 	6.77; ...
21.6 	6.83; ...
22.2 	6.83; ...
22.8 	6.94; ...
19.0 	6.68; ...
22.1 	6.83; ...
23.7 	6.93; ...
25.0 	6.94; ...
26.2 	7.03; ...
28.8 	7.11; ...
32.7 	7.26; ...
34.8 	7.34; ...
35.6 	7.32; ...
38.0 	7.45; ...
39.5 	7.48; ...
41.7 	7.54; ...
43.2 	7.59; ...
45.5 	7.67; ...
47.5 	7.73; ...
];

hplot = plot(osmop20k_data(:,1)/100, osmop20k_data(:,2), 's');
legend_add(hplot, 'PEG20K 20C, LPSB website data');

hplot = plot(concen, osmotic_pressure(concen, 'PEG20k', 20, 'NIH2013'));
legend_add(hplot, 'PEG20K 20C, NIH2013 formula');

osmop20k25_data = [ ...
     0.1490    6.4750; ... 
     0.1980    6.8250; ... 
     0.2480    7.0700; ... 
     0.2990    7.2850; ... 
     0.3550    7.5050; ...
     0.4020    7.6750; ...
    ];

hplot = plot(osmop20k25_data(:,1), osmop20k25_data(:,2), 'p');
legend_add(hplot, 'PEG20K 25C, NIH 11/13/2012');
legend boxoff

axis tight

saveps(gcf, [mfilename, '.eps']);

return;

hplot = plot(concen, osmotic_pressure(concen, 'PEG20k', 25));
legend_add(hplot, 'PEG20K 25C, revised formula');

legend('Location', 'SouthEast');
legend boxoff;
