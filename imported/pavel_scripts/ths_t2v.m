function v=ths_t2v(t)
%THS_T2V   convert temperature to voltage for S-type thermocouple
%   V = THS_T2V(T)   where T is in Celsius, V in Volts
%
%See also THS_V2T

tlo = [  -50.000 		1064.180		1664.500];
thi = [   1064.180		1664.500		1768.100 ];
p = [ 
	 0.000000000000E+00	 0.132900444085E+01	 0.146628232636E+03
	 0.540313308631E-02      0.334509311344E-02     -0.258430516752E+00
	 0.125934289740E-04      0.654805192818E-05      0.163693574641E-03
	-0.232477968689E-07     -0.164856259209E-08     -0.330439046987E-07
	 0.322028823036E-10      0.129989605174E-13     -0.943223690612E-14
	-0.331465196389E-13	0			0
	 0.255744251786E-16	0			0
	-0.125068871393E-19	0			0
	 0.271443176145E-23	0			0
];
p = 0.001 * flipud(p);
v = 0*t + NaN;
for i=1:length(tlo)
    j = find( t(:)>=tlo(i) & t(:)<thi(i) );
    v(j) = polyval(p(:,i), t(j));
end
